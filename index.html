<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice to Action Assistant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom animations */
        @keyframes pulse-ring {
            0% { transform: scale(0.33); }
            80%, 100% { transform: scale(2.4); opacity: 0; }
        }
        
        @keyframes pulse-dot {
            0% { transform: scale(0.8); }
            50% { transform: scale(1.0); }
            100% { transform: scale(0.8); }
        }
        
        .pulse-ring {
            animation: pulse-ring 1.25s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
        }
        
        .pulse-dot {
            animation: pulse-dot 1.25s cubic-bezier(0.455, 0.03, 0.515, 0.955) -0.4s infinite;
        }
        
        .listening-animation {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
            background-size: 400% 400%;
            animation: gradient 2s ease infinite;
        }
        
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .voice-wave {
            display: inline-block;
            width: 4px;
            height: 20px;
            background: #4f46e5;
            margin: 0 2px;
            animation: wave 1.2s infinite ease-in-out;
        }
        
        .voice-wave:nth-child(2) { animation-delay: -1.1s; }
        .voice-wave:nth-child(3) { animation-delay: -1.0s; }
        .voice-wave:nth-child(4) { animation-delay: -0.9s; }
        .voice-wave:nth-child(5) { animation-delay: -0.8s; }
        
        @keyframes wave {
            0%, 40%, 100% { transform: scaleY(0.4); }
            20% { transform: scaleY(1.0); }
        }
    </style>
</head>
<body class="min-h-screen transition-all duration-500" id="mainBody">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-4">
                üé§ Voice Assistant
            </h1>
            <p class="text-lg text-gray-600">
                Speak your commands and watch the magic happen!
            </p>
        </div>

        <!-- Voice Control Panel -->
        <div class="bg-white rounded-2xl shadow-xl p-8 mb-6">
            <!-- Status Display -->
            <div class="text-center mb-6">
                <div class="relative inline-block">
                    <div id="micIcon" class="w-20 h-20 bg-indigo-500 rounded-full flex items-center justify-center text-white text-3xl cursor-pointer transition-all duration-300 hover:bg-indigo-600">
                        üé§
                    </div>
                    <!-- Pulse rings for listening state -->
                    <div id="pulseRing1" class="absolute top-0 left-0 w-20 h-20 border-4 border-indigo-400 rounded-full opacity-75 pulse-ring hidden"></div>
                    <div id="pulseRing2" class="absolute top-0 left-0 w-20 h-20 border-4 border-indigo-300 rounded-full opacity-50 pulse-ring hidden" style="animation-delay: 0.5s;"></div>
                </div>
                
                <div id="statusText" class="mt-4 text-xl font-semibold text-gray-700">
                    Ready to listen
                </div>
                
                <!-- Voice wave animation -->
                <div id="voiceWave" class="mt-4 hidden">
                    <div class="voice-wave"></div>
                    <div class="voice-wave"></div>
                    <div class="voice-wave"></div>
                    <div class="voice-wave"></div>
                    <div class="voice-wave"></div>
                </div>
            </div>

            <!-- Control Buttons -->
            <div class="flex flex-wrap justify-center gap-4 mb-6">
                <button id="startBtn" class="px-6 py-3 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition-colors duration-300 flex items-center gap-2">
                    ‚ñ∂Ô∏è Start Listening
                </button>
                <button id="stopBtn" class="px-6 py-3 bg-red-500 text-white rounded-lg font-semibold hover:bg-red-600 transition-colors duration-300 disabled:opacity-50 flex items-center gap-2" disabled>
                    ‚èπÔ∏è Stop
                </button>
                <button id="clearBtn" class="px-6 py-3 bg-gray-500 text-white rounded-lg font-semibold hover:bg-gray-600 transition-colors duration-300 flex items-center gap-2">
                    üóëÔ∏è Clear
                </button>
            </div>

            <!-- Live Transcript -->
            <div class="bg-gray-50 rounded-lg p-4 mb-4">
                <h3 class="font-semibold text-gray-700 mb-2">Live Transcript:</h3>
                <div id="transcript" class="text-gray-600 min-h-[40px] italic">
                    Speak something...
                </div>
            </div>
        </div>

        <!-- Results Panel -->
        <div class="bg-white rounded-2xl shadow-xl p-8 mb-6">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Action Results</h2>
            <div id="results" class="space-y-4">
                <div class="text-gray-500 italic text-center py-8">
                    No actions performed yet. Try saying something like:
                    <br><br>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-2 text-sm">
                        <div>"Search for cats"</div>
                        <div>"Open YouTube"</div>
                        <div>"Change background color"</div>
                        <div>"Tell me the time"</div>
                        <div>"Write message to John - Hello"</div>
                        <div>"Turn on lights"</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Supported Commands -->
        <div class="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-2xl p-6">
            <h3 class="text-xl font-bold text-gray-800 mb-4">üéØ Supported Commands</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm">
                <div class="bg-white p-3 rounded-lg">
                    <strong>Search:</strong> "Search for [query]"
                </div>
                <div class="bg-white p-3 rounded-lg">
                    <strong>Open Sites:</strong> "Open YouTube/Google/Facebook"
                </div>
                <div class="bg-white p-3 rounded-lg">
                    <strong>Background:</strong> "Change background color"
                </div>
                <div class="bg-white p-3 rounded-lg">
                    <strong>Time:</strong> "Tell me the time"
                </div>
                <div class="bg-white p-3 rounded-lg">
                    <strong>Messages:</strong> "Write message to [name]"
                </div>
                <div class="bg-white p-3 rounded-lg">
                    <strong>Control:</strong> "Stop listening"
                </div>
            </div>
        </div>
    </div>

    <script>
        // Voice Recognition Setup and Global Variables
        let recognition = null;
        let isListening = false;
        let currentTranscript = '';
        
        // DOM Elements
        const startBtn = document.getElementById('startBtn');
        const stopBtn = document.getElementById('stopBtn');
        const clearBtn = document.getElementById('clearBtn');
        const transcript = document.getElementById('transcript');
        const results = document.getElementById('results');
        const statusText = document.getElementById('statusText');
        const micIcon = document.getElementById('micIcon');
        const pulseRing1 = document.getElementById('pulseRing1');
        const pulseRing2 = document.getElementById('pulseRing2');
        const voiceWave = document.getElementById('voiceWave');
        const mainBody = document.getElementById('mainBody');

        // Initialize Speech Recognition
        function initializeSpeechRecognition() {
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                alert('Your browser does not support speech recognition. Please use Chrome or a compatible browser.');
                return false;
            }

            // Create recognition instance
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();

            // Configuration
            recognition.continuous = true;          // Keep listening
            recognition.interimResults = true;     // Show partial results
            recognition.lang = 'en-US';           // Language setting

            // Event Handlers
            recognition.onstart = handleRecognitionStart;
            recognition.onresult = handleRecognitionResult;
            recognition.onerror = handleRecognitionError;
            recognition.onend = handleRecognitionEnd;

            return true;
        }

        // Recognition Event Handlers
        function handleRecognitionStart() {
            console.log('Speech recognition started');
            isListening = true;
            updateUI();
        }

        function handleRecognitionResult(event) {
            let interimTranscript = '';
            let finalTranscript = '';

            // Process all results
            for (let i = event.resultIndex; i < event.results.length; i++) {
                const transcriptSegment = event.results[i][0].transcript;
                
                if (event.results[i].isFinal) {
                    finalTranscript += transcriptSegment;
                } else {
                    interimTranscript += transcriptSegment;
                }
            }

            // Update live transcript
            currentTranscript = finalTranscript + interimTranscript;
            transcript.textContent = currentTranscript || 'Listening...';

            // Process final transcript for actions
            if (finalTranscript.trim()) {
                processVoiceCommand(finalTranscript.trim());
            }
        }

        function handleRecognitionError(event) {
            console.error('Speech recognition error:', event.error);
            let errorMessage = 'Recognition error: ';
            
            switch(event.error) {
                case 'no-speech':
                    errorMessage += 'No speech detected';
                    break;
                case 'audio-capture':
                    errorMessage += 'No microphone found';
                    break;
                case 'not-allowed':
                    errorMessage += 'Microphone permission denied';
                    break;
                default:
                    errorMessage += event.error;
            }
            
            addResult(errorMessage, 'error');
        }

        function handleRecognitionEnd() {
            console.log('Speech recognition ended');
            isListening = false;
            updateUI();
        }

        // Voice Command Processing
        function processVoiceCommand(command) {
            const lowerCommand = command.toLowerCase().trim();
            console.log('Processing command:', lowerCommand);

            // Stop command
            if (lowerCommand.includes('stop') || lowerCommand.includes('quit')) {
                stopListening();
                addResult('üõë Voice recognition stopped', 'action');
                return;
            }

            // Search commands
            if (lowerCommand.startsWith('search for') || lowerCommand.startsWith('search')) {
                const query = lowerCommand.replace(/^search\s+(for\s+)?/, '');
                if (query) {
                    performSearch(query);
                }
                return;
            }

            // Open website commands
            if (lowerCommand.includes('open')) {
                handleOpenCommand(lowerCommand);
                return;
            }

            // Background color change
            if (lowerCommand.includes('background') && lowerCommand.includes('color')) {
                changeBackgroundColor();
                return;
            }

            // Time request
            if (lowerCommand.includes('time') || lowerCommand.includes('what time')) {
                showCurrentTime();
                return;
            }

            // Message commands
            if (lowerCommand.includes('write message') || lowerCommand.includes('send message')) {
                handleMessageCommand(lowerCommand);
                return;
            }

            // Smart home commands (mock)
            if (lowerCommand.includes('turn on') || lowerCommand.includes('turn off')) {
                handleSmartHomeCommand(lowerCommand);
                return;
            }

            // Weather command
            if (lowerCommand.includes('weather')) {
                handleWeatherCommand();
                return;
            }

            // Default response for unrecognized commands
            addResult(`‚ùì Command not recognized: "${command}". Try a different command.`, 'info');
        }

        // Action Implementations
        function performSearch(query) {
            const searchUrl = `https://www.google.com/search?q=${encodeURIComponent(query)}`;
            window.open(searchUrl, '_blank');
            addResult(`üîç Searching for: "${query}"`, 'action');
        }

        function handleOpenCommand(command) {
            const sites = {
                'youtube': 'https://youtube.com',
                'google': 'https://google.com',
                'facebook': 'https://facebook.com',
                'twitter': 'https://twitter.com',
                'instagram': 'https://instagram.com',
                'linkedin': 'https://linkedin.com',
                'github': 'https://github.com',
                'whatsapp': 'https://web.whatsapp.com'
            };

            for (const [site, url] of Object.entries(sites)) {
                if (command.includes(site)) {
                    window.open(url, '_blank');
                    addResult(`üåê Opening ${site.charAt(0).toUpperCase() + site.slice(1)}`, 'action');
                    return;
                }
            }

            addResult('‚ùì Website not recognized. Try: YouTube, Google, Facebook, etc.', 'info');
        }

        function changeBackgroundColor() {
            const colors = [
                'bg-gradient-to-br from-purple-400 to-pink-400',
                'bg-gradient-to-br from-blue-400 to-indigo-600',
                'bg-gradient-to-br from-green-400 to-teal-500',
                'bg-gradient-to-br from-yellow-400 to-orange-500',
                'bg-gradient-to-br from-red-400 to-pink-500',
                'bg-gradient-to-br from-indigo-400 to-purple-600'
            ];

            // Remove existing background classes
            mainBody.className = mainBody.className.replace(/bg-gradient-to-br[\w\s-]*/g, '');
            
            // Add new background
            const randomColor = colors[Math.floor(Math.random() * colors.length)];
            mainBody.className += ` ${randomColor}`;
            
            addResult('üé® Background color changed!', 'action');
        }

        function showCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString();
            const dateString = now.toLocaleDateString();
            
            addResult(`üïê Current time: ${timeString} on ${dateString}`, 'info');
        }

        function handleMessageCommand(command) {
            // Extract recipient and message
            const messageMatch = command.match(/write message to (\w+)(?:\s*[-‚Äì]\s*(.+))?/i);
            
            if (messageMatch) {
                const recipient = messageMatch[1];
                const message = messageMatch[2] || 'Hello!';
                
                // For WhatsApp Web (if user wants to send to WhatsApp)
                if (command.includes('whatsapp') || command.includes('whats app')) {
                    const whatsappUrl = `https://web.whatsapp.com/send?text=${encodeURIComponent(message)}`;
                    window.open(whatsappUrl, '_blank');
                    addResult(`üì± Opening WhatsApp to send: "${message}" to ${recipient}`, 'action');
                } else {
                    // Mock message sending
                    addResult(`üì® Mock message sent to ${recipient}: "${message}"`, 'action');
                }
            } else {
                addResult('‚ùì Message format: "Write message to [name] - [message]"', 'info');
            }
        }

        function handleSmartHomeCommand(command) {
            const devices = ['light', 'lights', 'fan', 'tv', 'music', 'air conditioner'];
            const action = command.includes('turn on') ? 'on' : 'off';
            
            for (const device of devices) {
                if (command.includes(device)) {
                    addResult(`üí° Mock: Turned ${action} ${device}`, 'action');
                    return;
                }
            }
            
            addResult(`üí° Mock: Turned ${action} smart device`, 'action');
        }

        function handleWeatherCommand() {
            // Mock weather response
            const conditions = ['Sunny', 'Cloudy', 'Rainy', 'Partly Cloudy'];
            const temp = Math.floor(Math.random() * 20) + 15; // 15-35¬∞C
            const condition = conditions[Math.floor(Math.random() * conditions.length)];
            
            addResult(`üå§Ô∏è Mock Weather: ${condition}, ${temp}¬∞C`, 'info');
        }

        // UI Helper Functions
        function addResult(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const resultDiv = document.createElement('div');
            
            let bgColor = 'bg-blue-50 border-blue-200';
            if (type === 'action') bgColor = 'bg-green-50 border-green-200';
            if (type === 'error') bgColor = 'bg-red-50 border-red-200';
            
            resultDiv.className = `p-4 rounded-lg border ${bgColor} transition-all duration-300`;
            resultDiv.innerHTML = `
                <div class="flex justify-between items-start">
                    <div class="font-medium">${message}</div>
                    <div class="text-xs text-gray-500">${timestamp}</div>
                </div>
            `;

            // Clear placeholder text if it exists
            if (results.querySelector('.text-gray-500.italic')) {
                results.innerHTML = '';
            }

            results.insertBefore(resultDiv, results.firstChild);

            // Limit to 10 results
            while (results.children.length > 10) {
                results.removeChild(results.lastChild);
            }
        }

        function updateUI() {
            if (isListening) {
                statusText.textContent = 'Listening... Speak now!';
                statusText.className = 'mt-4 text-xl font-semibold text-green-600';
                micIcon.className = 'w-20 h-20 bg-green-500 rounded-full flex items-center justify-center text-white text-3xl cursor-pointer transition-all duration-300 listening-animation';
                startBtn.disabled = true;
                stopBtn.disabled = false;
                pulseRing1.classList.remove('hidden');
                pulseRing2.classList.remove('hidden');
                voiceWave.classList.remove('hidden');
            } else {
                statusText.textContent = 'Ready to listen';
                statusText.className = 'mt-4 text-xl font-semibold text-gray-700';
                micIcon.className = 'w-20 h-20 bg-indigo-500 rounded-full flex items-center justify-center text-white text-3xl cursor-pointer transition-all duration-300 hover:bg-indigo-600';
                startBtn.disabled = false;
                stopBtn.disabled = true;
                pulseRing1.classList.add('hidden');
                pulseRing2.classList.add('hidden');
                voiceWave.classList.add('hidden');
            }
        }

        // Control Functions
        function startListening() {
            if (!recognition) {
                if (!initializeSpeechRecognition()) return;
            }

            try {
                recognition.start();
                transcript.textContent = 'Starting...';
            } catch (error) {
                console.error('Error starting recognition:', error);
                addResult('Error starting voice recognition', 'error');
            }
        }

        function stopListening() {
            if (recognition && isListening) {
                recognition.stop();
            }
        }

        function clearResults() {
            results.innerHTML = `
                <div class="text-gray-500 italic text-center py-8">
                    Results cleared. Start speaking to see new actions!
                </div>
            `;
            transcript.textContent = 'Speak something...';
            currentTranscript = '';
        }

        // Event Listeners
        startBtn.addEventListener('click', startListening);
        stopBtn.addEventListener('click', stopListening);
        clearBtn.addEventListener('click', clearResults);
        micIcon.addEventListener('click', () => {
            if (isListening) {
                stopListening();
            } else {
                startListening();
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (event) => {
            if (event.key === ' ' && event.ctrlKey) { // Ctrl+Space to toggle
                event.preventDefault();
                if (isListening) {
                    stopListening();
                } else {
                    startListening();
                }
            }
        });

        // Initialize the app
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Voice Assistant App initialized');
            
            // Check browser compatibility
            if (!initializeSpeechRecognition()) {
                addResult('‚ö†Ô∏è Speech recognition not supported in this browser', 'error');
            } else {
                addResult('‚úÖ Voice Assistant ready! Click "Start Listening" or press Ctrl+Space', 'info');
            }
        });

        // Handle page visibility changes
        document.addEventListener('visibilitychange', () => {
            if (document.hidden && isListening) {
                // Stop recognition when page is hidden to save resources
                stopListening();
            }
        });
    </script>
</body>
</html>